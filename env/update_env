#!/bin/bash

# updates env with whatever new changes are found in the current environment

source "$HOME/.shell_control" || echo "$(tput bold)error: ~/.shell_control not installed!$(tput sgr0)" >&2

backup()
{
	run "rsync -apl '$1/$2' '$2'"
}

# profile
run "rsync -apl '$HOME/.profile' ./dot_profile"
for I in "$HOME/".profile_*; do
	if [[ ! -f ignore || -z "$(grep "$(basename "$I")" ignore)" ]]; then
    	run "rsync -apl '$I' './$(basename "$I" | sed 's/^./dot_/')'"
	fi
done

# bash
run "rsync -apl '$HOME/.bash_profile' ./dot_bash_profile"
run "rsync -apl '$HOME/.bashrc' ./dot_bashrc"

# zsh
run "rsync -apl '$HOME/.zshrc' ./dot_zshrc"

# tools
run "rsync -apl '$HOME/.dircolors' ./dot_dircolors"
run "rsync -apl '$HOME/.inputrc' ./dot_inputrc"
run "rsync -apl '$HOME/.vimrc' ./dot_vimrc"
run "rsync -apl '$HOME/.hgignore' ./dot_hgignore"
run "rsync -apl '$HOME/.hgrc' ./dot_hgrc"
run "rsync -apl '$HOME/.gitconfig' ./dot_gitconfig"
run "rsync -apl '$HOME/.pythonrc'.py ./dot_pythonrc.py"
run "rsync -apl '$HOME/.toprc' ./dot_toprc"
run "rsync -apl '$HOME/.complete/' ./dot_complete"

backup "$HOME/Library/Application Support/Sublime Text 3/Packages/User" "Preferences.sublime-settings"
backup "$HOME/Library/Application Support/Sublime Text 3/Packages/User" "SublimePython.sublime-settings"
