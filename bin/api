#!/bin/bash -u

# Requests a web API resource and pretty prints resulting JSON.

json_output=$(mktemp -t tmp.XXXXXXXXXX)
trap "rm -f $json_output" EXIT
cmd="curl -s '$*'"
echo "$cmd"
time eval "$cmd" >$json_output 2>&1
echo
cat $json_output | python -mjson.tool 2>/dev/null
if [[ $? != 0 ]]; then
	cat $json_output >&2
	exit 1
fi
