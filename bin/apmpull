#!/bin/bash -e

# Updates atom packages that are installed via git cloning them into ~/.atom/packages.

if [[ "$1" == "--help" || "$1" == "-h" ]]; then
    echo "usage: ${0##*/} [-h|--help]" 1>&2
    echo "Updates atom packages that are installed via git cloning them into ~/.atom/packages." 1>&2
    exit 1
fi

set -u
cd "$HOME/.atom/packages"
find . -not -path . -maxdepth 1 -type d -or -type l | while read dir; do
    [[ -d "$dir/.git" ]] || continue
    pushd "$dir" > /dev/null
    echo "$(tput bold)$(pwd)$(tput sgr0)"
    git pull
    popd > /dev/null
    echo
done
