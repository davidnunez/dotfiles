#!/bin/bash -ue

# Prepares given image for use in a README.md file.

if [[ "$1" == "--help" || "$1" == "-h" ]]; then
    echo "usage: ${0##*/} [-h|--help]" 1>&2
    echo "Prepares given image for use in a README.md file." 1>&2
    exit 1
fi

f="$1"
o="p-$f"
convert "$f" \
    -shave x25 \
    -colorspace RGB +sigmoidal-contrast 11.6933 \
    -define filter:filter=Sinc \
    -define filter:window=Jinc \
    -define filter:lobes=3 \
    -resize 700x \
    -sigmoidal-contrast 11.6933 \
    -colorspace sRGB \
    "$o"

# Animation:
# ffmpeg -i in.mov -s 704x344 -pix_fmt rgb24 -r 10 -f gif - | gifsicle --optimize=3 --delay=6 > out.gif; ls -lh out.gif
